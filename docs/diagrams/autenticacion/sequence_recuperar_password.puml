@startuml sequence_recuperar_password
!theme plain

title "Flujo de Recuperación de Contraseña"

actor Administrador
participant "Cliente (Frontend)" as Cliente
participant "API Gateway" as Gateway
participant "Servicio de Autenticación" as AuthServer
participant "Base de Datos" as DB

Administrador -> Cliente: Solicita recuperar contraseña para empleado (numeroIdentificacion)
Cliente -> Gateway: POST /auth/recuperar-password (numeroIdentificacion)
Gateway -> AuthServer: POST /auth/recuperar-password (numeroIdentificacion)

AuthServer -> DB: Buscar empleado por número de identificación
DB --> AuthServer: Retorna datos del empleado

alt Empleado existe
    AuthServer -> AuthServer: Generar contraseña temporal
    AuthServer -> AuthServer: Hashear contraseña temporal
    AuthServer -> DB: Actualizar contraseña y marcar como temporal
    DB --> AuthServer: Confirma actualización
    AuthServer --> Gateway: Devuelve contraseña temporal (solo para mostrar al admin)
    Gateway --> Cliente: 200 OK (Contraseña temporal generada)
    Cliente -> Administrador: Muestra contraseña temporal para comunicar al empleado
else Empleado no existe
    AuthServer --> Gateway: Devuelve error
    Gateway --> Cliente: 404 Not Found (Empleado no encontrado)
    Cliente -> Administrador: Muestra mensaje de error
end

@enduml
