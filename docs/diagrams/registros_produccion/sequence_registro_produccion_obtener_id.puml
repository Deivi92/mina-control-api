@startuml sequence_registro_produccion_obtener_id
title Secuencia: Obtener Registro de ProducciÃ³n por ID

actor Cliente as User
participant "RegistroProduccionController" as Ctrl
participant "RegistroProduccionService" as Srv
participant "RegistroProduccionRepository (In-Memory)" as RepoProd
participant "EmpleadoRepository (In-Memory)" as RepoEmp
participant "RegistroProduccion" as ModelProd
participant "Empleado" as ModelEmp
participant "RegistroProduccionResponseDTO" as ResDTO

User -> Ctrl : GET /api/registros-produccion/{id}
activate Ctrl
Ctrl -> Srv : obtenerRegistroPorId(id)
activate Srv
Srv -> RepoProd : findById(id)
activate RepoProd
RepoProd --> Srv : Optional<RegistroProduccion>
deactivate RepoProd
alt Registro Encontrado
    Srv -> RepoEmp : findById(registro.getResponsableTurnoId())
    activate RepoEmp
    RepoEmp --> Srv : Optional<Empleado>
    deactivate RepoEmp
    
    Srv -> ResDTO : fromEntity(registroEncontrado, empleadoEncontrado)
    activate ResDTO
    ResDTO --> Srv : registroResponseDTO
    deactivate ResDTO
    
    Srv --> Ctrl : registroResponseDTO
    Ctrl --> User : HTTP 200 OK (body: RegistroProduccionResponseDTO)
else Registro No Encontrado
    Srv --> Ctrl : throws RecursoNoEncontradoException("Registro no encontrado")
    deactivate Srv
    Ctrl -> GlobalExceptionHandler : maneja RecursoNoEncontradoException
    GlobalExceptionHandler --> Ctrl : ResponseEntity (Error)
    Ctrl --> User : HTTP 404 Not Found
end
deactivate Ctrl
@enduml
